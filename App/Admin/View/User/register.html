<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>用户注册</title>
    <link href="__CSS__/login.css" rel="stylesheet" type="text/css">
</head>

<body>

<div class="warp">
    <h1 class="logo">Hizip图书查阅</h1>

    <!--登陆框部分 start-->

    <!--登陆框主体 start-->
    <form id="form" action="__SELF__" method="post">
        <ol class="login clearfix">
            <li><span class="login_icon login_userImg"></span><input class="login_inp" type="text"
                                                                     ajaxurl="/member/checkUserNameUnique.html"
                                                                     datatype="*1-16"  name="username"
                                                                     errormsg="请填写1-16位用户名" nullmsg="请填写用户名"
                                                                     placeholder="请输入您的账号">
            </li>
            <li><span class="login_icon login_pwdImg"></span><input class="login_inp" type="password"
                                                                    errormsg="密码为6-20位" nullmsg="请填写密码"
                                                                    datatype="*6-20" name="password"
                                                                    placeholder="请输入您的密码">
            </li>
            <li><span class="login_icon login_pwdImg"></span><input class="login_inp" type="password"
                                                                    errormsg="密码为6-20位" nullmsg="请填写密码"
                                                                    datatype="*6-20" name="repassword"
                                                                    placeholder="请再次输入您的密码">
            </li>
            <li><span class="login_icon login_codeImg"></span><input class="login_inp" type="text"
                                                                     placeholder="请输入电子邮件"
                                                                     ajaxurl="/member/checkUserEmailUnique.html"
                                                                     errormsg="请填写正确格式的邮箱"
                                                                     nullmsg="请填写邮箱" datatype="e"
                                                                     value="" name="email">
            </li>
            <li><span class="login_icon login_pwdImg"></span><input class="login_codeInp" type="text"
                                                                     errormsg="请填写3位验证码" nullmsg="请填写验证码"
                                                                     datatype="*3-3" name="verify"
                                                                     placeholder="请输入验证码">
                <img class="login_code verifyimg reloadverify" alt="点击切换" src="{:U('verify')}">
            </li>
            <li>

                <button type="submit" class="login_btn">注 册</button>
            </li>
        </ol>
    </form>
    <!--登陆框主体 end-->
    <!--登陆框部分 end-->

</div>
</body>
</html>

<script src="__JS__/jquery.min.js"></script>
<script src="__JS__/slide.jquery.js"></script>
<script src="__JS__/dialog/layer.js"></script>
<script src="__JS__/dialog.js"></script>
<script type="text/javascript">
        $("form").submit(function(){
            var self = $(this);
            $.post(self.attr("action"), self.serialize(), success, "json");
            return false;

            function success(data){
                if(data.status){
                    window.location.href = data.url;
                } else {
                    dialog.error(data.info);
                    //刷新验证码
                    $(".reloadverify").click();
                }
            }
        });

        $(function(){
            var verifyimg = $(".verifyimg").attr("src");
            $(".reloadverify").click(function(){
                if( verifyimg.indexOf('?')>0){
                    $(".verifyimg").attr("src", verifyimg+'&random='+Math.random());
                }else{
                    $(".verifyimg").attr("src", verifyimg.replace(/\?.*$/,'')+'?'+Math.random());
                }
            });
        });
    </script>

